# Makefile cho Beach Volleyball Game

# Compiler
CXX = g++

# Tên file thực thi
TARGET = beach_volleyball

# Thư mục
SRC_DIR = src
BUILD_DIR = build

# Flags biên dịch
CXXFLAGS = -std=c++11 -Wall -Wextra
LDFLAGS = -lSDL2 -lSDL2_mixer

# Phát hiện hệ điều hành
UNAME := $(shell uname -s)

ifeq ($(UNAME), Darwin)
    # macOS
    CXXFLAGS += -I/opt/homebrew/include -I/usr/local/include
    LDFLAGS += -L/opt/homebrew/lib -L/usr/local/lib
else ifeq ($(UNAME), Linux)
    # Linux
    CXXFLAGS += $(shell pkg-config --cflags sdl2 SDL2_mixer)
    LDFLAGS = $(shell pkg-config --libs sdl2 SDL2_mixer)
else
    # Windows (MinGW)
    CXXFLAGS += -I/mingw64/include/SDL2
    LDFLAGS += -L/mingw64/lib -lmingw32 -lSDL2main -lSDL2 -lSDL2_mixer
endif

# Files nguồn
SOURCES = $(wildcard $(SRC_DIR)/*.cpp)
OBJECTS = $(SOURCES:$(SRC_DIR)/%.cpp=$(BUILD_DIR)/%.o)

# Targets
.PHONY: all clean run

all: $(BUILD_DIR) $(TARGET)

$(BUILD_DIR):
	mkdir -p $(BUILD_DIR)

$(TARGET): $(OBJECTS)
	$(CXX) $(OBJECTS) -o $@ $(LDFLAGS)

$(BUILD_DIR)/%.o: $(SRC_DIR)/%.cpp
	$(CXX) $(CXXFLAGS) -c $< -o $@

clean:
	rm -rf $(BUILD_DIR) $(TARGET)

run: $(TARGET)
	./$(TARGET)

# Hiển thị thông tin hệ thống
info:
	@echo "System: $(UNAME)"
	@echo "Compiler: $(CXX)"
	@echo "Sources: $(SOURCES)"
	@echo "Objects: $(OBJECTS)"
